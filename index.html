<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Water the Plant Game</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body {
  margin: 0;
  overflow: hidden;
  background: #cceeff;
  touch-action: none;
}
canvas {
  display: block;
}
</style>
</head>
<body>
<canvas id="game"></canvas>
<script>
// --- Embedded images (Base64 PNG) ---
const playerFrontImg = new Image();
playerFrontImg.src = "Front.png";
const playerBackImg = new Image();
playerBackImg.src = "Back.PNG";
const plantHealthyImg = new Image();
plantHealthyImg.src = "Health.PNG";
const plantWitheredImg = new Image();
plantWitheredImg.src = "Dead.PNG";

// --- Setup ---
const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d');
let W, H;
function resize() {
  W = canvas.width = window.innerWidth;
  H = canvas.height = window.innerHeight;
}
window.addEventListener('resize', resize);
resize();

// --- Game State ---
let player = { x: W/2, y: H-150, w: 80, h: 100, dir: 'front' };
let waterDrops = [];
let plant = { x: W/2-50, y: H-250, w: 100, h: 150, healthy: true, thirst: 5 };
let sunOrbs = [];
let score = 0;

// --- Controls ---
let touchStart = null;
canvas.addEventListener('touchstart', e => {
  touchStart = e.touches[0];
});
canvas.addEventListener('touchend', e => {
  if (!touchStart) return;
  let touchEnd = e.changedTouches[0];
  let dx = touchEnd.clientX - touchStart.clientX;
  let dy = touchEnd.clientY - touchStart.clientY;
  if (Math.abs(dy) < -10) return;
  if (Math.abs(dy) > 30) {
    // swipe to throw
    player.dir = 'back';
    waterDrops.push({ x: player.x, y: player.y, vx: dx/20, vy: dy/20 });
    setTimeout(() => player.dir = 'front', 200);
  } else {
    // horizontal move
    player.x += dx;
  }
  touchStart = null;
});

// --- Game Loop ---
function update() {
  // Move water
  waterDrops.forEach(d => { d.x += d.vx; d.y += d.vy; });
  waterDrops = waterDrops.filter(d => d.y > -50 && d.y < H+50);
  
  // Spawn sun
  if (Math.random() < 0.01) sunOrbs.push({ x: Math.random()*W, y: 0, r: 15 });
  sunOrbs.forEach(s => s.y += 2);
  sunOrbs = sunOrbs.filter(s => s.y < H+50);
  
  // Collision: water + plant
  waterDrops.forEach(d => {
    if (d.x > plant.x && d.x < plant.x + plant.w &&
        d.y > plant.y && d.y < plant.y + plant.h) {
      plant.thirst = 5;
      score++;
    }
  });
  
  // Collision: water + sun
  waterDrops.forEach(d => {
    sunOrbs.forEach(s => {
      if (Math.hypot(d.x - s.x, d.y - s.y) < s.r + 5) {
        score += 5;
        s.y = H + 100; // remove
      }
    });
  });
  
  // Thirst timer
  if (Math.random() < 0.01) plant.thirst--;
  if (plant.thirst <= 0) plant.healthy = false;
}

function draw() {
  ctx.clearRect(0,0,W,H);
  // Plant
  ctx.drawImage(plant.healthy ? plantHealthyImg : plantWitheredImg,
                plant.x, plant.y, plant.w, plant.h);
  // Player
  ctx.drawImage(player.dir==='front'?playerFrontImg:playerBackImg,
                player.x - player.w/2, player.y, player.w, player.h);
  // Water
  ctx.fillStyle = 'blue';
  waterDrops.forEach(d => {
    ctx.beginPath();
    ctx.arc(d.x, d.y, 5, 0, Math.PI*2);
    ctx.fill();
  });
  // Sun
  ctx.fillStyle = 'yellow';
  sunOrbs.forEach(s => {
    ctx.beginPath();
    ctx.arc(s.x, s.y, s.r, 0, Math.PI*2);
    ctx.fill();
  });
  // Score
  ctx.fillStyle = 'black';
  ctx.font = '20px sans-serif';
  ctx.fillText(`Score: ${score}`, 10, 30);
}

function loop() {
  update();
  draw();
  requestAnimationFrame(loop);
}
loop();
</script>
</body>
</html>
